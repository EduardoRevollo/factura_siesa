{"version":3,"sources":["services/auth.service.js","components/login.component.js","components/profile.component.js","common/EventBus.js","App.js","index.js"],"names":["username","password","localStorage","setItem","JSON","stringify","raw","fetch","method","body","headers","redirect","then","response","json","respuesta","toString","catch","error","console","log","codigo","nit","token","folio","removeItem","parse","getItem","required","value","className","role","Login","props","handleLogin","bind","onChangeUsername","onChangePassword","state","loading","message","e","this","setState","target","preventDefault","form","validateAll","checkBtn","context","_errors","length","AuthService","login","getToken","getFolio","result","detail","f_folio","history","push","window","location","reload","src","alt","onSubmit","ref","c","htmlFor","type","name","onChange","validations","disabled","style","display","Component","Profile","userReady","currentUser","getCurrentUser","getFactura","b64","f_bas64_rg","obj","document","createElement","width","height","data","appendChild","to","eventBus","on","event","callback","addEventListener","dispatch","dispatchEvent","CustomEvent","remove","removeEventListener","App","logOut","showModeratorBoard","showAdminBoard","undefined","user","EventBus","logout","href","onClick","exact","path","component","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.2aedb54b.chunk.js","sourcesContent":["class AuthService {  \r\n\r\n  login(username, password) {    \r\n    localStorage.setItem(\"user\", JSON.stringify({\"username\": username, \"password\": password}));\r\n  }\r\n  \r\n  getToken() {\r\n\r\n    const url = 'https://integracioneseco.co/ApiFacturas/api/login/authenticate';\r\n    \r\n    var raw = JSON.stringify({\r\n        \"Username\": \"ecocapital_pst\",\r\n        \"Password\": \"FactInt22+*\"\r\n    });\r\n    \r\n    var requestOptions = {\r\n        method: 'POST',\r\n        body: raw,\r\n        headers: {\"Content-Type\": \"application/json\"},      \r\n        redirect: 'follow'\r\n    };\r\n    \r\n    return fetch(url, requestOptions)\r\n        .then(response => response.json())\r\n        .then(respuesta => respuesta.toString())\r\n        .catch(error => console.log('error', error));    \r\n  }\r\n    \r\n    \r\n  getFolio(codigo, nit, token) {\r\n    const url = 'https://integracioneseco.co/ApiFacturas/api/facturas/getConsultaFacturas?f_id_cia=' + codigo +'&f_nit=' + nit;\r\n    let autorization = \"Bearer \" + token;\r\n  \r\n    var requestOptions = {\r\n      method: 'GET',\r\n      headers: {\"Authorization\": autorization},\r\n      redirect: 'follow'\r\n    };\r\n  \r\n    return fetch(url, requestOptions)\r\n      .then(response => response.json())\r\n      .catch(error => console.log('error', error));\r\n  }\r\n  \r\n  getFactura(folio, token) {\r\n    const url = 'https://integracioneseco.co/ApiFacturas/api/facturas/postConsultaDocumentoPDF';\r\n  \r\n    var raw = JSON.stringify({\r\n      \"f_id_cia\": 1,\r\n      \"f_tipo_documento\": \"1\",\r\n      \"f_folio\": folio\r\n    });\r\n  \r\n    var autorization = \"Bearer \" + token;\r\n  \r\n    var requestOptions = {\r\n      method: 'POST',\r\n      body: raw,\r\n      headers: {\"Authorization\": autorization,\"Content-Type\": \"application/json\"},\r\n      redirect: 'follow'\r\n    };\r\n  \r\n    return fetch(url, requestOptions)\r\n      .then(response => response.json())\r\n      .catch(error => console.log('error', error));\r\n  }  \r\n\r\n  logout() {\r\n    localStorage.removeItem(\"user\");\r\n  }\r\n\r\n  getCurrentUser() {\r\n    return JSON.parse(localStorage.getItem('user'));;\r\n  }\r\n}\r\n\r\nexport default new AuthService();\r\n","import React, { Component } from \"react\";\r\nimport Form from \"react-validation/build/form\";\r\nimport Input from \"react-validation/build/input\";\r\nimport CheckButton from \"react-validation/build/button\";\r\n\r\nimport AuthService from \"../services/auth.service\";\r\n\r\nconst required = value => {\r\n  if (!value) {\r\n    return (\r\n      <div className=\"alert alert-danger\" role=\"alert\">\r\n        This field is required!\r\n      </div>\r\n    );\r\n  }\r\n};\r\n\r\nexport default class Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleLogin = this.handleLogin.bind(this);\r\n    this.onChangeUsername = this.onChangeUsername.bind(this);\r\n    this.onChangePassword = this.onChangePassword.bind(this);\r\n\r\n    this.state = {\r\n      username: \"\",\r\n      password: \"\",\r\n      loading: false,\r\n      message: \"\"\r\n    };\r\n  }\r\n\r\n  onChangeUsername(e) {\r\n    this.setState({\r\n      username: e.target.value\r\n    });\r\n  }\r\n\r\n  onChangePassword(e) {\r\n    this.setState({\r\n      password: e.target.value\r\n    });\r\n  }\r\n\r\n  handleLogin(e) {\r\n    e.preventDefault();\r\n\r\n    this.setState({\r\n      message: \"\",\r\n      loading: true\r\n    });\r\n\r\n    this.form.validateAll();\r\n\r\n    if (this.checkBtn.context._errors.length === 0) {\r\n\r\n      localStorage.setItem('username', this.state.username);\r\n      localStorage.setItem('password', this.state.password);\r\n      AuthService.login(this.state.username, this.state.password);\r\n\r\n      AuthService.getToken().then(\r\n        (token) => {\r\n            console.log(token);\r\n            localStorage.setItem('token', token);\r\n            //AuthService.getFolio(localStorage.getItem('username'),localStorage.getItem('password'),localStorage.getItem('token'))\r\n            AuthService.getFolio(this.state.username,this.state.password,token)\r\n            .then(response => {\r\n              console.log(response);\r\n              if (response.result === \"success\") {\r\n                var folio = response.detail[0].f_folio.toString();\r\n                localStorage.setItem('folio', folio);\r\n                this.props.history.push(\"/factura_siesa/profile\");\r\n                window.location.reload();\r\n              }\r\n              else {\r\n                this.setState({\r\n                  loading: false\r\n                });\r\n                console.log('Usuario o contraseña incorrectos');                \r\n              }\r\n            });\r\n        }\r\n      );\r\n    } else {\r\n      this.setState({\r\n        loading: false\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"col-md-12\">\r\n        <div className=\"card card-container\">\r\n          <img\r\n            src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\"\r\n            alt=\"profile-img\"\r\n            className=\"profile-img-card\"\r\n          />\r\n\r\n          <Form\r\n            onSubmit={this.handleLogin}\r\n            ref={c => {\r\n              this.form = c;\r\n            }}\r\n          >\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"username\">Username</label>\r\n              <Input\r\n                type=\"text\"\r\n                className=\"form-control\"\r\n                name=\"username\"\r\n                value={this.state.username}\r\n                onChange={this.onChangeUsername}\r\n                validations={[required]}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"password\">Password</label>\r\n              <Input\r\n                type=\"password\"\r\n                className=\"form-control\"\r\n                name=\"password\"\r\n                value={this.state.password}\r\n                onChange={this.onChangePassword}\r\n                validations={[required]}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <button\r\n                className=\"btn btn-primary btn-block\"\r\n                disabled={this.state.loading}\r\n              >\r\n                {this.state.loading && (\r\n                  <span className=\"spinner-border spinner-border-sm\"></span>\r\n                )}\r\n                <span>Login</span>\r\n              </button>\r\n            </div>\r\n\r\n            {this.state.message && (\r\n              <div className=\"form-group\">\r\n                <div className=\"alert alert-danger\" role=\"alert\">\r\n                  {this.state.message}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <CheckButton\r\n              style={{ display: \"none\" }}\r\n              ref={c => {\r\n                this.checkBtn = c;\r\n              }}\r\n            />\r\n          </Form>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport AuthService from \"../services/auth.service\";\r\n\r\nexport default class Profile extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      redirect: null,\r\n      userReady: false,\r\n      currentUser: { username: \"\" }\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const currentUser = AuthService.getCurrentUser();\r\n\r\n    if (!currentUser) {\r\n      this.setState({ redirect: \"/login\" });\r\n    }\r\n    else {\r\n      this.setState({ currentUser: currentUser, userReady: true });\r\n \r\n          AuthService.getFactura(localStorage.getItem('folio'), localStorage.getItem('token'))\r\n          .then(response => {\r\n              var b64 = response.detail[0].f_bas64_rg.toString();\r\n              localStorage.setItem('base64', b64);\r\n              \r\n              var obj = document.createElement('object');\r\n              obj.style.width = '100%';\r\n              obj.style.height = '842pt';\r\n              obj.type = 'application/pdf';\r\n              obj.data = 'data:application/pdf;base64,' + b64;\r\n              document.body.appendChild(obj);\r\n              \r\n          });          \r\n\r\n    }\r\n  }\r\n\r\n  \r\n  render() {\r\n    if (this.state.redirect) {\r\n      return <Redirect to={this.state.redirect} />\r\n    }\r\n    return (\r\n      null\r\n    );\r\n  }\r\n}\r\n","const eventBus = {\r\n  on(event, callback) {\r\n    document.addEventListener(event, (e) => callback(e.detail));\r\n  },\r\n  dispatch(event, data) {\r\n    document.dispatchEvent(new CustomEvent(event, { detail: data }));\r\n  },\r\n  remove(event, callback) {\r\n    document.removeEventListener(event, callback);\r\n  },\r\n};\r\n\r\nexport default eventBus;\r\n","import React, { Component } from \"react\";\r\nimport { Switch, Route, Link } from \"react-router-dom\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport \"./App.css\";\r\nimport AuthService from \"./services/auth.service\";\r\nimport Login from \"./components/login.component\";\r\nimport Profile from \"./components/profile.component\";\r\nimport EventBus from \"./common/EventBus\";\r\n\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.logOut = this.logOut.bind(this);\r\n\r\n    this.state = {\r\n      showModeratorBoard: false,\r\n      showAdminBoard: false,\r\n      currentUser: undefined,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const user = AuthService.getCurrentUser();\r\n\r\n    if (user) {\r\n      this.setState({\r\n        currentUser: user,\r\n        showModeratorBoard: true,\r\n        showAdminBoard: false,\r\n      });\r\n    }\r\n    \r\n    EventBus.on(\"logout\", () => {\r\n      this.logOut();\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    EventBus.remove(\"logout\");\r\n  }\r\n\r\n  logOut() {\r\n    AuthService.logout();\r\n    this.setState({\r\n      showModeratorBoard: false,\r\n      showAdminBoard: false,\r\n      currentUser: undefined,\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { currentUser } = this.state;\r\n\r\n    return (\r\n      <div>\r\n        <nav className=\"navbar navbar-expand navbar-dark bg-dark\">\r\n          {currentUser ? (\r\n            <div className=\"navbar-nav ml-auto\">\r\n              <li className=\"nav-item\">\r\n                <Link to={\"/factura_siesa/profile\"} className=\"nav-link\">\r\n                  {currentUser.username}\r\n                </Link>\r\n              </li>\r\n              <li className=\"nav-item\">\r\n                <a href=\"/factura_siesa/login\" className=\"nav-link\" onClick={this.logOut}>\r\n                  LogOut\r\n                </a>\r\n              </li>\r\n            </div>\r\n          ) : (\r\n            <div className=\"navbar-nav ml-auto\">\r\n              <li className=\"nav-item\">\r\n                <Link to={\"/factura_siesa/login\"} className=\"nav-link\">\r\n                  Login\r\n                </Link>\r\n              </li>\r\n            </div>\r\n          )}\r\n        </nav>\r\n\r\n        <div className=\"container mt-3\">\r\n          <Switch>\r\n            <Route exact path=\"/factura_siesa/\" component={Login} />\r\n            <Route exact path=\"/factura_siesa/login\" component={Login} />\r\n            <Route exact path=\"/factura_siesa/profile\" component={Profile} />\r\n          </Switch>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { BrowserRouter } from \"react-router-dom\";\r\n\r\nimport App from \"./App\";\r\n//import * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(\r\n  <BrowserRouter>\r\n    <App />\r\n  </BrowserRouter>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n//serviceWorker.unregister();\r\n"],"sourceRoot":""}